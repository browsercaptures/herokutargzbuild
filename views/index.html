<style>
    .apps {
        font-family: monospace;
        border-collapse: collapse;
    }
    .apps td {
        padding: 5px;
        border: solid 1px;
    }
</style>

Dummy App {{ welcomeMsg }}

<div id="app" />

<template id="template">
    <table class="apps">
        <tr>
            <td>App Name</td>
            <td>App Id</td>
            <td>Created At</td>
            <td>Updated At</td>
            <td>Region</td>
        </tr>
        <tr v-for="app in apps">
            <td>[[ app.name ]]</td>
            <td>[[ app.id ]]</td>
            <td>[[ app.created_at ]]</td>
            <td>[[ app.updated_at ]]</td>
            <td>[[ app.region.name ]]</td>
            <!--<td><pre>[[ app ]]</pre></td>-->
        </tr>
    </table>
</template>

<script src="/vue"></script>

<script>
    function get(endpoint){
        return new Promise(resolve=>{
            fetch(endpoint).then(resp => resp.json().then(json => {
                resolve(json)
            }))
        })
    }
</script>

<script>
    document.title = "{{ title }}"

    const appConfig = {
        methods: {
            getApps(){
                get("/apps").then(json => this.apps = json)
            }
        },
        data() {
            return {
                apps: []
            }
        },
        mounted(){
            this.getApps()
        },
        compilerOptions: {
            delimiters: ["[[", "]]"]
        },
        template: document.getElementById("template").innerHTML
    }

    const app = Vue.createApp(appConfig)

    app.mount('#app')

    const createdAt = {{ createdAt }}

    setInterval(()=>{
        get("/createdat").then(json => {
            if(json !== createdAt) document.location.reload()
        })
    }, 500)
</script>
